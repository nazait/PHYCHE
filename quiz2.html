<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>PHYCHE</title>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />
    <link rel="stylesheet" href="PHYCHE.css">

</head>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      text-align: center;
    }
  </style>
</head>
<body>

  <section id="header">
        <a href="#"><img src="./LOOGO.png" class="logo" alt=""></a>
        <div>
            <ul id="navbar">
                <li><a class="active" href="PHYCHE.html">Accueil</a></li>
                <li ><a  href="chaine youtube.html">chaine youtube</a></li>
                <li><a href="Contact.html">Contact</a></li>
            </ul>
        </div>
        </div>
    </section>

  <!-- Ã‰TAPE 1 : Formulaire Ã©tudiant -->
  <div id="login" class="container">
    <h2>Connexion Ã‰tudiant</h2>
    <input type="text" id="prenom" placeholder="PrÃ©nom" required><br>
    <input type="text" id="nom" placeholder="Nom" required><br>
    <input type="text" id="niveau" placeholder="Niveau scolaire (ex: 3Ã¨me annÃ©e collÃ¨ge)" required><br>
    <input type="text" id="classe" placeholder="Classe" required><br>
    <input type="text" id="massar" placeholder="Code Massar" required><br>
    <button onclick="demarrerQuiz()">Connexion</button>
  </div>

  <div id="infosEtudiant" style="margin-bottom: 20px; margin-top: 40px; font-weight: bold;"></div>

  <div id="timer" style="font-weight: bold; margin-bottom: 10px;"></div>

  <!-- Ã‰TAPE 2 : Quiz -->
  <div id="quiz" class="quiz-container" style="display: none;">
    <div id="question" class="question"></div>
    <div id="answers" class="answers"></div>
    <div id="result"></div>
  </div>

  <script>
    let timer;
    let timeLeft = 20;

    const quiz = [
  {
    question: "Quelle proportion de la surface de la Terre est recouverte par lâ€™eau ?",
    answers: ["Environ la moitiÃ©", "Environ 3/4", "Environ 10 %", "100 %"],
    correct: "Environ 3/4"
  },
  {
    question: "Pourquoi lâ€™eau est-elle importante pour les Ãªtres humains ?",
    answers: ["Elle est utilisÃ©e pour la dÃ©coration", "Elle est indispensable Ã  la vie", "Elle sert uniquement Ã  laver", "Elle est toxique pour le corps humain"],
    correct: "Elle est indispensable Ã  la vie"
  },
  {
    question: "Comment appelle-t-on lâ€™ensemble des rÃ©serves dâ€™eau sur la Terre ?",
    answers: ["Lâ€™atmosphÃ¨re", "Lâ€™hydrosphÃ¨re", "La lithosphÃ¨re", "La biosphÃ¨re"],
    correct: "Lâ€™hydrosphÃ¨re"
  },
  {
    question: "Sous quelle forme lâ€™eau est-elle prÃ©sente dans lâ€™atmosphÃ¨re ?",
    answers: ["Glace", "Pluie solide", "Vapeur dâ€™eau", "Neige"],
    correct: "Vapeur dâ€™eau"
  },
  {
    question: "Le passage de lâ€™Ã©tat solide Ã  lâ€™Ã©tat liquide sâ€™appelle :",
    answers: ["Lâ€™Ã©vaporation", "La solidification", "La fusion", "La liquÃ©faction"],
    correct: "La fusion"
  },
  {
    question: "Le passage de lâ€™Ã©tat liquide Ã  lâ€™Ã©tat gazeux sâ€™appelle :",
    answers: ["La fusion", "Lâ€™Ã©vaporation", "La liquÃ©faction", "La sublimation"],
    correct: "Lâ€™Ã©vaporation"
  },
  {
    question: "Quelle substance permet de dÃ©tecter la prÃ©sence dâ€™eau ?",
    answers: ["Nitrate dâ€™argent", "Sulfate de cuivre anhydre", "Acide chlorhydrique", "Chlorure de sodium"],
    correct: "Sulfate de cuivre anhydre"
  },
  {
    question: "Que devient le sulfate de cuivre anhydre en prÃ©sence dâ€™eau ?",
    answers: ["Il devient rouge", "Il devient noir", "Il devient bleu", "Il reste blanc"],
    correct: "Il devient bleu"
  },
  {
    question: "Quelle substance permet de dÃ©tecter la prÃ©sence dâ€™eau dans les aliments ?",
    answers: ["Nitrate dâ€™argent", "Sulfate de cuivre anhydre", "Chlorure de sodium", "Acide sulfurique"],
    correct: "Sulfate de cuivre anhydre"
  },
  {
    question: "Que se passe-t-il lorsque le sulfate de cuivre anhydre entre en contact avec un aliment contenant de lâ€™eau ?",
    answers: ["Il devient rouge", "Il devient blanc", "Il devient bleu", "Il dÃ©gage une odeur"],
    correct: "Il devient bleu"
  },
  {
    question: "Comment appelle-t-on lâ€™ensemble des rÃ©serves dâ€™eau sur la Terre ?",
    answers: ["Lâ€™atmosphÃ¨re", "Lâ€™hydrosphÃ¨re", "La lithosphÃ¨re", "La cryosphÃ¨re"],
    correct: "Lâ€™hydrosphÃ¨re"
  },
  {
    question: "Quelle proportion de la surface de la Terre est recouverte dâ€™eau ?",
    answers: ["10 %", "50 %", "70 %", "90 %"],
    correct: "70 %"
  },
  {
    question: "Quel est lâ€™autre nom donnÃ© Ã  la surface dâ€™eau sur Terre ?",
    answers: ["Lâ€™ocÃ©an", "La mer", "Lâ€™hydrosphÃ¨re", "La planÃ¨te bleue"],
    correct: "La mer"
  },
  {
    question: "De quelle couleur est le sulfate de cuivre anhydre ?",
    answers: ["Bleu", "Blanc", "Rouge", "Vert"],
    correct: "Blanc"
  },
  {
    question: "Quels sont les trois Ã©tats physiques de lâ€™eau ?",
    answers: ["Solide, liquide et gazeux", "Froid, chaud et tiÃ¨de", "Mou, dur et fluide", "Gel, neige et pluie"],
    correct: "Solide, liquide et gazeux"
  },
  {
    question: "En prÃ©sence dâ€™eau, le sulfate de cuivre anhydre devient :",
    answers: ["Blanc", "Bleu", "Rouge", "Jaune"],
    correct: "Bleu"
  },
  {
    question: "Comment sâ€™appelle le passage de lâ€™eau liquide Ã  lâ€™Ã©tat gazeux ?",
    answers: ["LiquÃ©faction", "Ã‰vaporation", "Condensation", "Fusion"],
    correct: "Ã‰vaporation"
  },
  {
    question: "Comment sâ€™appelle le passage de lâ€™eau solide Ã  lâ€™eau liquide ?",
    answers: ["Solidification", "Condensation", "Fusion", "LiquÃ©faction"],
    correct: "Fusion"
  },
  {
    question: "Quand la vapeur dâ€™eau passe Ã  lâ€™Ã©tat liquide, cela sâ€™appelle :",
    answers: ["Sublimation", "Fusion", "Condensation", "Ã‰vaporation"],
    correct: "Condensation"
  },
  {
    question: "Quelle est la couleur du sulfate de cuivre utilisÃ© pour dÃ©tecter lâ€™eau ?",
    answers: ["Anhydre", "Rouge", "Bleu", "Vert"],
    correct: "Bleu"
  },
  {
    question: "Quel est le pourcentage dâ€™eau dans le corps humain ?",
    answers: ["30 %", "50 %", "70 %", "90 %"],
    correct: "70 %"
  },
  {
    question: "Parmi les grands rÃ©servoirs dâ€™eau, on trouve :",
    answers: ["Le dÃ©sert", "Les ocÃ©ans", "Les volcans", "Les montagnes"],
    correct: "Les ocÃ©ans"
  },
  {
    question: "Le principal constituant des boissons est :",
    answers: ["Le sucre", "Le gaz", "Lâ€™eau", "Les colorants"],
    correct: "Lâ€™eau"
  },
  {
    question: "Le cycle de lâ€™eau est un Ã©change entre :",
    answers: ["Lâ€™atmosphÃ¨re et la Terre", "Les ocÃ©ans et les animaux", "Les plantes et les riviÃ¨res", "Les glaciers et les volcans"],
    correct: "Lâ€™atmosphÃ¨re et la Terre"
  }
    ];

    let currentQuestion = 0;
    let score = 0;
    let etudiant = {};

    function demarrerQuiz() {
      // RÃ©cupÃ©ration des donnÃ©es Ã©tudiant
      etudiant = {
        prenom: document.getElementById("prenom").value,
        nom: document.getElementById("nom").value,
        niveau: document.getElementById("niveau").value,
        classe: document.getElementById("classe").value,
        massar: document.getElementById("massar").value
      };

      // VÃ©rifie que tous les champs sont remplis
      if (!etudiant.nom || !etudiant.prenom || !etudiant.niveau || !etudiant.classe || !etudiant.massar) {
        alert("Veuillez remplir toutes les informations.");
        return;
      }

      // Affiche les infos de lâ€™Ã©tudiant en haut
  document.getElementById("infosEtudiant").innerHTML = 
    `Ã‰tudiant : ${etudiant.prenom} ${etudiant.nom} | Niveau : ${etudiant.niveau} | Classe : ${etudiant.classe} | Code Massar : ${etudiant.massar}`;

      document.getElementById("login").style.display = "none";
      document.getElementById("quiz").style.display = "block";
      showQuestion();
    }

    function showQuestion() {
  const q = quiz[currentQuestion];
  document.getElementById("question").textContent = q.question;

  const answersDiv = document.getElementById("answers");
  answersDiv.innerHTML = "";
  document.getElementById("result").textContent = "";

  // RÃ©initialise le timer
  clearInterval(timer);
  timeLeft = 20;
  document.getElementById("timer").textContent = `Temps restant : ${timeLeft}s`;

  timer = setInterval(() => {
    timeLeft--;
    document.getElementById("timer").textContent = `Temps restant : ${timeLeft}s`;

    if (timeLeft <= 0) {
      clearInterval(timer);
      passerQuestion();
    }
  }, 1000);

  q.answers.forEach(answer => {
    const btn = document.createElement("button");
    btn.textContent = answer;
    btn.onclick = () => checkAnswer(answer, btn);
    answersDiv.appendChild(btn);
  });
}


    function checkAnswer(selectedAnswer, selectedBtn) {
  clearInterval(timer); // â¹ï¸ Stop le timer

  const q = quiz[currentQuestion];
  const allButtons = document.querySelectorAll("#answers button");

  allButtons.forEach(button => {
    button.disabled = true;
    if (button.textContent === q.correct) {
      button.style.backgroundColor = "lightgreen";
    } else {
      button.style.backgroundColor = "#f8d7da";
    }
  });

  if (selectedAnswer === q.correct) {
    score++;
  } else {
    selectedBtn.style.backgroundColor = "#f44336";
  }

  setTimeout(() => {
    currentQuestion++;
    if (currentQuestion < quiz.length) {
      showQuestion();
    } else {
      showResult();
    }
  }, 1500);
}

function passerQuestion() {
  const q = quiz[currentQuestion];
  const allButtons = document.querySelectorAll("#answers button");

  allButtons.forEach(button => {
    button.disabled = true;
    if (button.textContent === q.correct) {
      button.style.backgroundColor = "lightgreen";
    } else {
      button.style.backgroundColor = "#f8d7da";
    }
  });

  setTimeout(() => {
    currentQuestion++;
    if (currentQuestion < quiz.length) {
      showQuestion();
    } else {
      showResult();
    }
  }, 1500);
}

function enregistrerResultat() {
  // RÃ©cupÃ©rer les anciens rÃ©sultats du localStorage
  const anciensResultats = JSON.parse(localStorage.getItem("resultats")) || [];

  // Ajouter le nouveau rÃ©sultat
  anciensResultats.push({
    prenom: etudiant.prenom,
    nom: etudiant.nom,
    score: `${score}/${quiz.length}`
  });

  // Sauvegarder Ã  nouveau dans le localStorage
  localStorage.setItem("resultats", JSON.stringify(anciensResultats));

  // Afficher le tableau
  afficherTableau(anciensResultats);
}



    function showResult() {
      document.getElementById("question").textContent = "Quiz terminÃ© !";
      document.getElementById("answers").innerHTML = "";
      const message = `Score : ${score}/${quiz.length}`;
      document.getElementById("result").textContent = message;

      // CrÃ©e un message complet avec les infos
      const msg = `PrÃ©nom: ${etudiant.prenom}
Nom: ${etudiant.nom}
Niveau: ${etudiant.niveau}
Classe: ${etudiant.classe}
Code Massar: ${etudiant.massar}
Score: ${score}/${quiz.length}`;

      // Envoi via fetch sans changer de page
fetch("https://formspree.io/f/movwvbjl", {
  method: "POST",
  headers: {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
  },
  body: JSON.stringify({
    email: "boocebarca20172@gmail.com",
    message: msg
  })
})
.then(response => {
  if (response.ok) {
    console.log("Score envoyÃ© avec succÃ¨s !");
  } else {
    console.error("Erreur lors de lâ€™envoi du score.");
  }
});

  enregistrerResultat();

  // Sauvegarder l'Ã©tudiant dans localStorage
let classement = JSON.parse(localStorage.getItem("classementQuiz")) || [];
classement.push({
  nomComplet: `${etudiant.prenom} ${etudiant.nom}`,
  score: score
});
localStorage.setItem("classementQuiz", JSON.stringify(classement));

// Affiche le classement
document.getElementById("classement").style.display = "block";

classement.sort((a, b) => b.score - a.score); // tri par score dÃ©croissant

const tableau = document.getElementById("tableauClassement");
tableau.innerHTML = ""; // vider avant

classement.forEach((etudiant, index) => {
  const ligne = document.createElement("tr");
  ligne.innerHTML = `
    <td>${index + 1}</td>
    <td>${etudiant.nomComplet}</td>
    <td>${etudiant.score}</td>
  `;
  tableau.appendChild(ligne);
});

// Affiche un podium simple
const podiumDiv = document.getElementById("podium");
const top3 = classement.slice(0, 3);
let podiumHTML = "";
if (top3[0]) podiumHTML += `ðŸ¥‡ ${top3[0].nomComplet} (${top3[0].score})<br>`;
if (top3[1]) podiumHTML += `ðŸ¥ˆ ${top3[1].nomComplet} (${top3[1].score})<br>`;
if (top3[2]) podiumHTML += `ðŸ¥‰ ${top3[2].nomComplet} (${top3[2].score})<br>`;
podiumDiv.innerHTML = podiumHTML;




    }
    function afficherTableau(resultats) {
  const corpsTableau = document.getElementById("corpsTableau");
  corpsTableau.innerHTML = "";

  // Trier les rÃ©sultats par score dÃ©croissant
  resultats.sort((a, b) => {
    // Extraire le score numÃ©rique (ex: "3/5" â†’ 3)
    const scoreA = parseInt(a.score.split("/")[0]);
    const scoreB = parseInt(b.score.split("/")[0]);
    return scoreB - scoreA; // ordre dÃ©croissant
  });

  // Afficher les rÃ©sultats avec classement
  resultats.forEach((etud, index) => {
    const ligne = document.createElement("tr");
    ligne.innerHTML = `
      <td>${index + 1}</td>
      <td>${etud.prenom}</td>
      <td>${etud.nom}</td>
      <td>${etud.score}</td>
    `;
    corpsTableau.appendChild(ligne);
  });

  document.getElementById("tableauResultats").style.display = "block";
}


  </script>

  <!-- RÃ©sultats enregistrÃ©s (tableau localStorage) -->
<div id="tableauResultats" style="display:none; margin-top: 40px;">
  <h2>ðŸ“Š RÃ©sultats des Ã©tudiants prÃ©cÃ©dents</h2>
  <table border="1" style="width:100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th>Rang</th>
        <th>PrÃ©nom</th>
        <th>Nom</th>
        <th>Score</th>
      </tr>
    </thead>
    <tbody id="corpsTableau">
      <!-- Les rÃ©sultats s'ajouteront ici dynamiquement -->
    </tbody>
  </table>
</div>


  <!-- Podium visuel -->
  <div id="podium" style="margin-top: 20px; font-size: 1.5em;"></div>
</div>



</body>
</html>
